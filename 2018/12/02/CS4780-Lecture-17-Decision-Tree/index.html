<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="English">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="2018FA,Study Notes,ML,">










<meta name="description" content="Motivation for Decision TreesK-nearest neighbor classifier is really powerful in low dimensions, since it allows non-linear boundaries. However, it needs a huge amount of storage because it requires s">
<meta name="keywords" content="2018FA,Study Notes,ML">
<meta property="og:type" content="article">
<meta property="og:title" content="CS4780 Lecture 17: Decision Tree">
<meta property="og:url" content="http://yoursite.com/2018/12/02/CS4780-Lecture-17-Decision-Tree/index.html">
<meta property="og:site_name" content="Joseph Yang&#39;s Homepage">
<meta property="og:description" content="Motivation for Decision TreesK-nearest neighbor classifier is really powerful in low dimensions, since it allows non-linear boundaries. However, it needs a huge amount of storage because it requires s">
<meta property="og:locale" content="English">
<meta property="og:image" content="http://yoursite.com/2018/12/02/CS4780-Lecture-17-Decision-Tree/1.png">
<meta property="og:image" content="http://yoursite.com/2018/12/02/CS4780-Lecture-17-Decision-Tree/2.png">
<meta property="og:updated_time" content="2018-12-03T15:40:07.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CS4780 Lecture 17: Decision Tree">
<meta name="twitter:description" content="Motivation for Decision TreesK-nearest neighbor classifier is really powerful in low dimensions, since it allows non-linear boundaries. However, it needs a huge amount of storage because it requires s">
<meta name="twitter:image" content="http://yoursite.com/2018/12/02/CS4780-Lecture-17-Decision-Tree/1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/12/02/CS4780-Lecture-17-Decision-Tree/">





  <title>CS4780 Lecture 17: Decision Tree | Joseph Yang's Homepage</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="English">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <a href="https://github.com/josephzxyang"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_darkblue_121621.png" alt="Fork me on GitHub"></a>
    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Joseph Yang's Homepage</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Welcome!</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/02/CS4780-Lecture-17-Decision-Tree/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Joseph (Zhaoxu) Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joseph Yang's Homepage">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">CS4780 Lecture 17: Decision Tree</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-12-02T11:03:11-05:00">
                2018-12-02
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/CS-4780-Study-Notes/" itemprop="url" rel="index">
                    <span itemprop="name">CS 4780 Study Notes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="Motivation-for-Decision-Trees"><a href="#Motivation-for-Decision-Trees" class="headerlink" title="Motivation for Decision Trees"></a>Motivation for Decision Trees</h3><p>K-nearest neighbor classifier is really powerful in low dimensions, since it allows non-linear boundaries. However, it needs a huge amount of storage because it requires storage of entire training data. The more training data there are, the slower the classifier works. So we want get around the dilemma while still utilizing the simple but great idea of KNN. Here comes K-dimension decision Trees.</p>
<a id="more"></a>
<blockquote>
<p>Basic idea of KNN: inputs with similar features tend to have same labels.</p>
</blockquote>
<p>The assumption of KNN implies that points of different classes are not sprinkled randomly, but appears in clusters or groups. So we could store nodes that represent different clusters instead of all training points. This is how KD tree works.</p>
<ul>
<li><p>Advantages of KD Tree over KNN</p>
<ol>
<li>Once the tree is constructed, the training data does not need to be stored. Instead, we can simply store how many points of each label ended up in each leaf - typically these are pure so we just have to store the label of all points.</li>
<li>decision trees are very fast during test time, as test inputs simply need to traverse down the tree to a leaf - the prediction is the majority label of the leaf.</li>
<li>decision trees require no metric because the splits are based on feature thresholds and not distances.</li>
</ol>
</li>
</ul>
<p>Q: When KD Trees do not work?<br>A: When points are far from each other. Each point is on some boundary. This happens if dimension goes very high. Just like how KNN does not work due to curse of dimensionality. But KNN still works in high dimensional space if all points are all in some low dimensional manifold (for example, a 2D plane in 100D space). But KD Trees still don’t work.</p>
<p><img src="/2018/12/02/CS4780-Lecture-17-Decision-Tree/1.png" alt="Comparison between brute force and ball"></p>
<p>This is a demonstration of brute force search vs. ball tree search. Left is time comparison and right is computation comparison. Note that the overall time of ball tree could be longer than the time of standard brute force search even if ball tree search requires much fewer computations than brute force. This is because modern computers are designed with two things: cache performance and parallelism. Multicore parallelism is highly optimized, thus matrix multiplication can be done in very fast way. But for ball tree computation, you can only do one computation at a time, hence losing the advantage of computer parallelism.</p>
<p>Q: Is it always possible that for any data set, we could have a tree such that all points in any leaf nodes have the same label?<br>A: No, because it is possible that two points with exact same features but different labels. But if no such case exists, then yes.</p>
<p>Bad news: Finding a <strong>minimum size</strong> tree is NP-hard.<br>Good news: we could approximate it greedily. Keep splitting data to minimize an <strong>inpurity function</strong>.</p>
<h3 id="Impurity-Function"><a href="#Impurity-Function" class="headerlink" title="Impurity Function"></a>Impurity Function</h3><p>What we have: groups of data $\mathbf{D} = $ {$(x_{1}, y_{1}), (x_{2}, y_{2}),…, (x_{n}, y_{n})$} where $\forall i, y_{i}\in$ {$1,2,3,…,c$}</p>
<h4 id="Gini-Impurity"><a href="#Gini-Impurity" class="headerlink" title="Gini Impurity"></a>Gini Impurity</h4><p>Let $D_{k}$ denote class $k$. Define $$p_{k} = \frac{|D_{k}|}{|D|}$$.<br>The Gini impurity function is defined as: $$G_{D} = \sum_{k=1}^{c}p_{k}\cdot (1-p_{k})$$.<br>The Gini impurity function for a tree is defined as: $$G_{D} = \frac{|D_{L}|}{|D|}G_{D_{L}} + \frac{|D_{R}|}{|D|}G_{D_{R}}$$</p>
<h4 id="KL-Divergence-and-Entropy"><a href="#KL-Divergence-and-Entropy" class="headerlink" title="KL-Divergence and Entropy"></a>KL-Divergence and Entropy</h4><p>Uniform distribution over leaves is the least thing we want (i.e. our decision tree does nothing else but random guessing, all leaf nodes have same probability). We could use KL-Divergence to represent how close our result is to uniform distribution. Maximizing the KL-Divergence is actually minimizing the entropy of our tree, since probability of every leaf in uniform distribution is the same constant $\frac{1}{c}$. So the entropy function could also be an impurity function.<br>$$H(D) = -\sum_{k=1}^{c}p_{k}\cdot log(p_{k})$$<br>Here, $p_{k}$ is defined the same as in Gini impurity.</p>
<h3 id="ID3-Algorithm"><a href="#ID3-Algorithm" class="headerlink" title="ID3-Algorithm"></a>ID3-Algorithm</h3><p>The ID3-algorithm stops under two circumstances:</p>
<ul>
<li>If all points in a node have the same label, stop and the node has that label.</li>
<li>If all points in a node have exactly the same features, stop and the node has the label that appears most in the node.</li>
</ul>
<p>Quiz: Why don’t we stop until we cannot improve impurity?<br>Answer: XOR is an example<br><img src="/2018/12/02/CS4780-Lecture-17-Decision-Tree/2.png" alt="Comparison between brute force and ball"><br>Explanation: The first split does not improve impurity. So decision trees are myopic.</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/2018FA/" rel="tag"># 2018FA</a>
          
            <a href="/tags/Study-Notes/" rel="tag"># Study Notes</a>
          
            <a href="/tags/ML/" rel="tag"># ML</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/12/01/CS4780-Lecture-13-Kernels/" rel="next" title="CS 4780 Lecture 13: Kernels">
                <i class="fa fa-chevron-left"></i> CS 4780 Lecture 13: Kernels
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/12/02/TF-IDF/" rel="prev" title="TF-IDF">
                TF-IDF <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Joseph (Zhaoxu) Yang</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Motivation-for-Decision-Trees"><span class="nav-number">1.</span> <span class="nav-text">Motivation for Decision Trees</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Impurity-Function"><span class="nav-number">2.</span> <span class="nav-text">Impurity Function</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Gini-Impurity"><span class="nav-number">2.1.</span> <span class="nav-text">Gini Impurity</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#KL-Divergence-and-Entropy"><span class="nav-number">2.2.</span> <span class="nav-text">KL-Divergence and Entropy</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ID3-Algorithm"><span class="nav-number">3.</span> <span class="nav-text">ID3-Algorithm</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Joseph (Zhaoxu) Yang</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
